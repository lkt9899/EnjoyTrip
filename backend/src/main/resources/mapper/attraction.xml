<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.ssafy.attraction.model.dao.AttractionRepository">
	<resultMap id="attractionResponse" type="Attraction">
		<result column="content_id" property="contentId"/>
		<result column="content_type_id" property="contentTypeId"/>
		<result column="title" property="title" />
		<result column="addr1" property="addr1"/>
		<result column="addr2" property="addr2"/>
		<result column="zipcode" property="zipcode"/>
		<result column="tel" property="tel"/>
		<result column="first_image" property="firstImage"/>
		<result column="first_image2" property="firstImage2"/>
		<result column="readcount" property="readcount" />
		<result column="sido_code" property="sidoCode"/>
		<result column="gugun_code" property="gugunCode"/>
		<result column="latitude" property="latitude" />
		<result column="longitude" property="longitude" />
		<result column="mlevel" property="mlevel" />
	</resultMap>

	<!--	게시글 목록-->
	<select id="select" parameterType="SearchCondition" resultMap="attractionResponse">
		SELECT
		    content_id,
		    content_type_id,
		    title,
		   	addr1,
		   	addr2,
		   	zipcode,
		   	tel,
		   	first_image,
		  	first_image2,
		   	readCount,
		   	sido_code,
		   	gugun_code,
		   	latitude,
		   	longitude,
		   	mlevel
		FROM attraction_info
		WHERE 1=1
		    <if test="sidoCode != null">
				AND sido_code = #{sidoCode}
			</if>
			<if test="gugunCode != null">
				AND gugun_code = #{gugunCode}
			</if>
			<if test="contentTypeId != null">
				AND content_type_id = #{contentTypeId}
			</if>
	</select>
	
	<select id="selectCountOfAttraction" resultType="int">
		SELECT COUNT(*) as count
		FROM attraction_info
	</select>

	<!--게시글 목록 : 스크롤-->
	<select id="selectByScroll" parameterType="queryParams" resultMap="attractionResponse">
		SELECT
		content_id,
		content_type_id,
		title,
		addr1,
		addr2,
		zipcode,
		tel,
		first_image,
		first_image2,
		readCount,
		sido_code,
		gugun_code,
		latitude,
		longitude,
		mlevel
		FROM attraction_info
		WHERE content_id > #{pagingInfo.offset}
		<if test="searchCondition.sidoCode != null">
			AND sido_code = #{searchCondition.sidoCode}
		</if>
		<if test="searchCondition.gugunCode != null">
			AND gugun_code = #{searchCondition.gugunCode}
		</if>
		<if test="searchCondition.contentTypeId != null">
			AND content_type_id = #{searchCondition.contentTypeId}
		</if>
		ORDER BY content_id
		LIMIT #{pagingInfo.COUNT}
	</select>

	<select id="getAttractionInfo" resultType="">

	</select>
</mapper>